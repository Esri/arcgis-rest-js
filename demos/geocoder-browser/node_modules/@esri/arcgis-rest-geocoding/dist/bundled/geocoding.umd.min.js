/* @preserve
* @esri/arcgis-rest-geocoding - v4.0.0-beta.2 - Apache-2.0
* Copyright (c) 2017-2022 Esri, Inc.
* Thu Mar 10 2022 23:21:10 GMT+0000 (Coordinated Universal Time)
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@esri/arcgis-rest-request")):"function"==typeof define&&define.amd?define(["exports","@esri/arcgis-rest-request"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).arcgisRest=e.arcgisRest||{},e.arcgisRest)}(this,(function(e,t){"use strict";const r="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer/",n="https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/";
/* @preserve
  * @terraformer/arcgis - v2.0.7 - MIT
  * Copyright (c) 2012-2021 Environmental Systems Research Institute, Inc.
  * Thu Jul 22 2021 13:58:30 GMT-0700 (Pacific Daylight Time)
  */
var o=function(e,t,r,n){var o=(n[0]-r[0])*(e[1]-r[1])-(n[1]-r[1])*(e[0]-r[0]),s=(t[0]-e[0])*(e[1]-r[1])-(t[1]-e[1])*(e[0]-r[0]),i=(n[1]-r[1])*(t[0]-e[0])-(n[0]-r[0])*(t[1]-e[1]);if(0!==i){var a=o/i,c=s/i;if(a>=0&&a<=1&&c>=0&&c<=1)return!0}return!1},s=function(e,t){for(var r=0;r<e.length-1;r++)for(var n=0;n<t.length-1;n++)if(o(e[r],e[r+1],t[n],t[n+1]))return!0;return!1},i=function(e){for(var t,r=0,n=0,o=e.length,s=e[n];n<o-1;n++)r+=((t=e[n+1])[0]-s[0])*(t[1]+s[1]),s=t;return r>=0},a=function(e,t){var r=s(e,t),n=function(e,t){for(var r=!1,n=-1,o=e.length,s=o-1;++n<o;s=n)(e[n][1]<=t[1]&&t[1]<e[s][1]||e[s][1]<=t[1]&&t[1]<e[n][1])&&t[0]<(e[s][0]-e[n][0])*(t[1]-e[n][1])/(e[s][1]-e[n][1])+e[n][0]&&(r=!r);return r}(e,t[0]);return!(r||!n)},c=function e(t,r){var n={};if(t.features){n.type="FeatureCollection",n.features=[];for(var o=0;o<t.features.length;o++)n.features.push(e(t.features[o],r))}if("number"==typeof t.x&&"number"==typeof t.y&&(n.type="Point",n.coordinates=[t.x,t.y],"number"==typeof t.z&&n.coordinates.push(t.z)),t.points&&(n.type="MultiPoint",n.coordinates=t.points.slice(0)),t.paths&&(1===t.paths.length?(n.type="LineString",n.coordinates=t.paths[0].slice(0)):(n.type="MultiLineString",n.coordinates=t.paths.slice(0))),t.rings&&(n=function(e){for(var t,r,n,o,c=[],u=[],l=0;l<e.length;l++){var p=(function(e,t){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}((o=e[l].slice(0))[0],o[o.length-1])||o.push(o[0]),o);if(!(p.length<4))if(i(p)){var f=[p.slice().reverse()];c.push(f)}else u.push(p.slice().reverse())}for(var d=[];u.length;){n=u.pop();var g=!1;for(t=c.length-1;t>=0;t--)if(r=c[t][0],a(r,n)){c[t].push(n),g=!0;break}g||d.push(n)}for(;d.length;){n=d.pop();var y=!1;for(t=c.length-1;t>=0;t--)if(r=c[t][0],s(r,n)){c[t].push(n),y=!0;break}y||c.push([n.reverse()])}return 1===c.length?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}(t.rings.slice(0))),"number"==typeof t.xmin&&"number"==typeof t.ymin&&"number"==typeof t.xmax&&"number"==typeof t.ymax&&(n.type="Polygon",n.coordinates=[[[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax]]]),(t.geometry||t.attributes)&&(n.type="Feature",n.geometry=t.geometry?e(t.geometry):null,n.properties=t.attributes?function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(t.attributes):null,t.attributes))try{n.id=function(e,t){for(var r=t?[t,"OBJECTID","FID"]:["OBJECTID","FID"],n=0;n<r.length;n++){var o=r[n];if(o in e&&("string"==typeof e[o]||"number"==typeof e[o]))return e[o]}throw Error("No valid id attribute found")}(t.attributes,r)}catch(e){}return JSON.stringify(n.geometry)===JSON.stringify({})&&(n.geometry=null),t.spatialReference&&t.spatialReference.wkid&&4326!==t.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(t.spatialReference)),n};e.ARCGIS_ONLINE_BULK_GEOCODING_URL=n,e.ARCGIS_ONLINE_GEOCODING_URL=r,e.bulkGeocode=function(e){const r=Object.assign({endpoint:n,params:{}},e);return r.params.addresses={records:e.addresses.map((e=>({attributes:e})))},e.authentication||r.endpoint!==n?t.request(`${t.cleanUrl(r.endpoint)}/geocodeAddresses`,r).then((e=>{if(r.rawResponse)return e;const t=e.spatialReference;return e.locations.forEach((function(e){e.location&&(e.location.spatialReference=t)})),e})):Promise.reject("bulk geocoding using the ArcGIS service requires authentication")},e.geocode=function(e){let n,o={};return"string"==typeof e?(o.params={singleLine:e},n=r):(n=e.endpoint||r,o=t.appendCustomParams(e,["singleLine","address","address2","address3","neighborhood","city","subregion","region","postal","postalExt","countryCode","outFields","magicKey"],{params:Object.assign({},e.params)})),t.request(`${t.cleanUrl(n)}/findAddressCandidates`,o).then((t=>{if("string"!=typeof e&&e.rawResponse)return t;const r=t.spatialReference;if(t.candidates.forEach((function(e){e.location.spatialReference=r,e.extent&&(e.extent.spatialReference=r)})),4326===r.wkid){const e=t.candidates.map((e=>({type:"Feature",geometry:c(e.location),properties:Object.assign({address:e.address,score:e.score},e.attributes)})));t.geoJson={type:"FeatureCollection",features:e}}return t}))},e.getGeocodeService=function(e){const n=e&&e.endpoint||r,o=Object.assign({httpMethod:"GET",maxUrlLength:2e3},e);return t.request(n,o)},e.reverseGeocode=function(e,n){const o=Object.assign({endpoint:r,params:{}},n);return!function(e){return 2===e.length||3===e.length}(e)?!function(e){return void 0!==e.latitude||void 0!==e.lat}(e)?o.params.location=e:(e.lat&&(o.params.location=e.long+","+e.lat),e.latitude&&(o.params.location=e.longitude+","+e.latitude)):o.params.location=e.join(),t.request(`${t.cleanUrl(o.endpoint)}/reverseGeocode`,o)},e.suggest=function(e,n){const o=Object.assign({endpoint:r,params:{}},n);return o.params.text=e,t.request(`${t.cleanUrl(o.endpoint)}/suggest`,o)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=geocoding.umd.min.js.map
